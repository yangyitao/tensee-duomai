<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0" />
    <meta name="format-detection" content="telephone=no" />
    <title>转正申请流程</title>
    <link href="../../css/aui.css" rel="stylesheet" />
    <style>
        .aui-input-row .aui-input-addon {
            width: 110px;
            color: #8f8f94;
            text-align: left;
        }

        .aui-input-form .aui-input-row .aui-input-addon {
            padding-left: 8px;
            font-weight: 300;
            font-size: 13px;
        }

        .aui-list-view-cell {
            padding: 5px 15px;
        }

        .aui-label-title {
            text-align: right;
            width: 90px;
        }
    </style>
</head>
<body>
    <input id="KPI" type="hidden" />
    <input id="EmpID" type="hidden" />
    <div id="main">
        <p class="aui-padded-5 aui-text-center" style="color: #3175af; font-size: 16px;">转正申请流程</p>
        <div class="aui-card" style="margin-bottom: 0px;">
            <ul class="aui-list-view" style="margin-bottom: 0px;">
                <li class="aui-list-view-cell">
                    <label id="InfoSN"></label>
                    <p>单号</p>
                </li>
                <li class="aui-list-view-cell">
                    <label id="InfoEmpName"></label>
                    <p>姓名</p>
                </li>
                <li class="aui-list-view-cell">
                    <label id="InfoWriteDate"></label>
                    <p>日期</p>
                </li>
                <li class="aui-list-view-cell">
                    <label id="InfoEmpCode"></label>
                    <p>工号</p>
                </li>
                <li class="aui-list-view-cell" data-role="baseMore" style="display: none">
                    <label id="InfoInDate"></label>
                    <p>入职日期</p>
                </li>
                <li class="aui-list-view-cell" data-role="baseMore" style="display: none">
                    <label id="InfoAreaName"></label>
                    <p>大区</p>
                </li>
                <li class="aui-list-view-cell" data-role="baseMore" style="display: none">
                    <label id="InfoProvince"></label>
                    <p>区域</p>
                </li>
                <li class="aui-list-view-cell" data-role="baseMore" style="display: none">
                    <label id="InfoPositionAge"></label>
                    <p>岗龄</p>
                </li>
                <li class="aui-list-view-cell" data-role="baseMore" style="display: none">
                    <label id="InfoEmpPosition"></label>
                    <p>岗位</p>
                </li>
                <li class="aui-list-view-cell" data-role="baseMore" style="display: none">
                    <label id="InfoSapCode"></label>
                    <p>店铺代码</p>
                </li>
                <li class="aui-list-view-cell" data-role="baseMore" style="display: none">
                    <label id="InfoShopName"></label>
                    <p>店铺名称</p>
                </li>
                <li data-role="colspan" data-show="hide" class="aui-list-view-cell" id="liBaseMore">
                    <p style="text-align: center">点击显示详情</p>
                </li>
            </ul>
        </div>
        <p class="aui-padded-5 aui-text-left" style="color: #3175af; margin: 0 10px; font-size: 15px;">培训考核成绩</p>
        <div class="aui-card aui-input-form" style="margin-bottom: 0px;">
            <div class="aui-input-row" id="Div1">
                <span class="aui-input-addon">基础商品知识</span>
                <input id="Test1" type="text" class="aui-input" style="padding-left: 13px !important" readonly="readonly" />
            </div>
            <div class="aui-input-row">
                <span class="aui-input-addon">基础销售技巧</span>
                <input id="Test2" type="text" class="aui-input aui-important" style="padding-left: 13px !important" readonly="true" />
            </div>
            <div class="aui-input-row">
                <span class="aui-input-addon">卡宾店铺服务标准</span>
                <input id="Test3" type="text" class="aui-input aui-important" readonly="true" />
            </div>
            <div class="aui-input-row">
                <span class="aui-input-addon">卡宾品牌知识</span>
                <input id="Test4" type="text" class="aui-input aui-important" style="padding-left: 13px !important" readonly="true" />
            </div>
            <div class="aui-input-row">
                <span class="aui-input-addon">三天闯关</span>
                <input id="PassThreeDay" type="text" class="aui-input aui-important" style="padding-left: 13px !important" readonly="true" />
            </div>
            <div class="aui-input-row">
                <span class="aui-input-addon">培训成绩平均分</span>
                <input id="Score" type="text" class="aui-input aui-important" style="padding-left: 13px !important" readonly="true" />
            </div>
        </div>
        <p class="aui-padded-5 aui-text-left" style="color: #3175af; margin: 0 10px; font-size: 15px;">业绩达成</p>
        <div class="aui-card aui-input-form" style="margin-bottom: 0px;">
            <div class="aui-input-row">
                <span class="aui-input-addon">业绩达成率</span>
                <textarea id="KPIText" class="aui-input" style="height: 70px; border: 1px solid #c8c7cc; overflow-y: auto" readonly="readonly"></textarea>
            </div>
        </div>
        <p class="aui-padded-5 aui-text-left" style="color: #3175af; margin: 0 10px; font-size: 15px;">其他</p>
        <div class="aui-card aui-input-form" style="margin-bottom: 0px;">
            <div class="aui-input-row" id="TransDateFrom">
                <span class="aui-input-addon">转正日期</span>
                <input id="TransDate" type="text" class="aui-input" placeholder="请输入申请晋升时间" readonly="readonly" />
            </div>
            <div class="aui-input-row">
                <span class="aui-input-addon">带教师傅</span>
                <input id="Tutor1" type="text" class="aui-input aui-important" disabled="disabled" placeholder="请填写带教师傅" />
            </div>
            <div class="aui-input-row">
                <span class="aui-input-addon">自我评价</span>
                <input id="Appraise" type="text" class="aui-input aui-important" placeholder="请填写自我评价" disabled="disabled" />
            </div>
        </div>
        <p class="aui-padded-5 aui-text-left" style="color: #3175af; margin: 0 10px; font-size: 15px;">个人考勤</p>
        <div class="aui-card aui-input-form" style="margin-bottom: 0px;">
            <div class="aui-input-row">
                <span class="aui-input-addon">迟到早退次数</span>
                <input id="Tardy" type="text" class="aui-input aui-important" readonly="true" />
            </div>
            <div class="aui-input-row">
                <span class="aui-input-addon">旷工天数</span>
                <input id="Absent" type="text" class="aui-input aui-important" readonly="true" />
            </div>
            <div class="aui-input-row">
                <span class="aui-input-addon">事假天数</span>
                <input id="Casual" type="text" class="aui-input aui-important" readonly="true" />
            </div>
            <div class="aui-input-row">
                <span class="aui-input-addon">病假天数</span>
                <input id="Sick" type="text" class="aui-input aui-important" readonly="true" />
            </div>
            <div class="aui-input-row" style="color: red; padding: 0 3px; font-size: 13px;">
                从试用期之日起，一个月内旷工累计达1天、事假累计达3天、病假累计达5天、迟到、早退达5次,不予审批通过！
            </div>
        </div>
        <div style="height: 100px"></div>
    </div>
</body>
<script src="../../script/api.js"></script>
<script src="../../script/zepto.js"></script>
<script src="../../script/honesty.base.js"></script>
<script src="../../script/honesty.flow.js"></script>
<script src="../../script/honesty.valid.js"></script>
<script type="text/javascript">
    var IsRead = false;
    var PositiveID = "";
    var NowDate = $honesty.NowDate();
    apiready = function () {
        api.parseTapmode();
        $(function () {
            $honestyFlow.InitFlow({ Async: false, wapflowpage: "HRFlow/EmpPositive" });
            var InstanceID = $honestyFlow.GetFlowInfo("instanceid");
            if (api.pageParam.instanceid != undefined) {
                PositiveID = InstanceID;
            }
            if ($honestyFlow.GetFlowInfo("stepname") == "提出转正申请") {
                $("#Tutor1,#Appraise,#btnSlaves").removeAttr("disabled", "");
                $("#TransDateFrom").css("display", "none");
            }
            if ($honestyFlow.GetFlowInfo("stepname") == "店铺店长审批") {
                $("#Tutor1,#Appraise,#btnSlaves").removeAttr("disabled", "");
                $("#TransDateFrom").css("display", "");
            }
            if ($honestyFlow.GetFlowInfo("stepname") == "区经审批") {
                $("#TransDateFrom").css("display", "");
            }
            //基本信息点击展示隐藏
            $("#liBaseMore").tap(function () {
                $("[data-role='baseMore']").fadeToggle(200);
                if ($("#liBaseMore").attr("data-show") == "hide") {
                    $("#liBaseMore").children("p").html("点击收起");
                    $("#liBaseMore").attr("data-show", "show");
                }
                else {
                    $("#liBaseMore").children("p").html("点击显示详情");
                    $("#liBaseMore").attr("data-show", "hide");
                }
            });

            InitBase();
            $("#btnSlaves").tap(function () {
                $honesty.UploadSlaves("tbSlaves");
            });
            $("#TransDate").tap(function () {
                if ($honestyFlow.GetFlowInfo("stepname") == "店铺店长审批" || $honestyFlow.GetFlowInfo("stepname") == "区经审批") {
                    $honesty.DateTimeSelect({
                        ControlID: "TransDate",
                        ControlValue: $(this).val(),
                        onchange: function (ret) {
                            if (ret) {
                                if ($("#TransDate").val() != "") {
                                    var _Date = new Date($("#TransDate").val().replace(/-/g, "/"));
                                    var _TransDate = _Date.getFullYear() + "/" + (_Date.getMonth() + 1) + "/" + "01";
                                    $("#TransDate").val(new Date(_TransDate).Format("yyyy/MM/dd"));
                                    var _NowDate = NowDate.getFullYear() + "/" + ((NowDate.getMonth() + 1) < 10 ? "0" + (NowDate.getMonth() + 1) : (NowDate.getMonth() + 1)) + "/" + "01";
                                    var _dt = new Date(NowDate);
                                    var nextdate = new Date(_dt.getFullYear(), (_dt.getMonth() + 1), 01).Format("yyyy/MM/dd");
                                    if ($("#TransDate").val() != _NowDate && $("#TransDate").val() != nextdate) {
                                        $honesty.ShowMsg({ msg: "转正日期只能是当月1号或者次月1号！", title: "警告" });
                                        $("#TransDate").val("");
                                    }
                                }
                            }
                        }
                    });
                }
            });

            //提交
            $("#btnSend").unbind("tap").tap(function () {
                if (SaveData()) {
                    $honestyFlow.SendFlow();
                }
            });
            //暂存
            $("#btnPause").unbind("tap").tap(function () {
                if (SaveData()) {
                    $honestyFlow.PauseFlow();
                }
            });
            //完成
            $("#btnComplete").unbind("tap").tap(function () {
                if (SaveData()) {
                    var EmpPositive = {
                        PostData: {
                            ITable: {
                                "PTI_ZZBD": [{
                                    ZEMID: $("#EmpID").val(),
                                    ZLSDH: $honestyFlow.GetFlowInfo("sn"),
                                    ZSPRQ: NowDate,
                                    ZZZRQ: $("#TransDate").val(),
                                }]
                            },
                            Export: [
                                "POC_RETURN_ID",
                                "POC_RETURN_DESC"
                            ],
                            FunctionName: "ZHR_FM_ZZ_INPUT",
                            Mode: "RFC"
                        },
                        async: false
                    };
                    var _result = $honesty.AjaxChannel(EmpPositive);
                    if (_result.Code == "1") {
                        if (_result.Data.Export.POC_RETURN_ID == "000") {
                            $honestyFlow.CompleteFlow(function () {
                                var _options = {
                                    PostData: {
                                        Params: {
                                            result: "UpDateUser",
                                            EmpID: $("#EmpID").val()
                                        },
                                        ProcName: "proc_SOM_HR_EmpPositive",
                                        DataType: "Bool",
                                        ExecType: "PROC",
                                        Mode: "MSSQL"
                                    },
                                    async: false
                                };
                                var _result = $honesty.AjaxChannel(_options);
                                if (_result.Data == "True") {
                                    $honesty.ShowMsg({
                                        title: "提示",
                                        msg: "员工信息更新成功"
                                    })
                                }
                            });
                        }
                        else {
                            $honesty.ShowMsg({ msg: _result.Data.Export.POC_RETURN_DESC, title: "警告" });
                        }
                    }
                }
            });
        })
    };
    //加载基础信息
    function InitBase() {
        if ($honestyFlow.GetFlowInfo("isread") == "false") {
            IsRead = true;
        }
        if (PositiveID != "") {
            var _options = {
                PostData: {
                    Params: {
                        Result: "InitEmpPositive",
                        ID: PositiveID
                    },
                    ProcName: "proc_SOM_HR_EmpPositive",
                    DataType: "DataTable",
                    ExecType: "PROC",
                    Mode: "MSSQL"
                }
            };
            $.when($honesty.AjaxChannel(_options)).done(function (_result) {
                if (_result.Code == "1") {
                    if (_result.Data.length > 0) {
                        $.each(_result.Data, function (i, item) {
                            $("#InfoSN").html(item.SN);
                            $("#InfoWriteDate").html(item.WriteDate);
                            $("#InfoEmpCode").html(item.EmpCode);
                            $("#InfoEmpName").html(item.EmpName);
                            $("#InfoAreaName").html(item.AreaName);
                            $("#InfoProvince").html(item.Province);
                            $("#InfoSapCode").html(item.SapCode);
                            $("#InfoShopName").html(item.ShopName);
                            $("#InfoEmpPosition").html(item.EmpPosition);
                            $("#InfoPositionAge").html(item.PositionAge + "天");
                            $("#InfoInDate").html(item.InDate);
                            //加载附件列表
                            $honesty.InitSlaves({
                                con_id: "tbSlaves", dataname: "tbSlaves", move: IsRead, files: item.Slaves
                            });
                            $("#KPIText").val(item.KPIText);
                            $("#KPI").val(item.KPI);
                            $("#Test1").val(item.Test1);
                            $("#Test2").val(item.Test2);
                            $("#Test3").val(item.Test3);
                            $("#Test4").val(item.Test4);
                            $("#Score").val(item.Score);
                            $("#Tutor1").val(item.Tutor1);
                            $("#PassThreeDay").val(item.PassThreeDay);
                            $("#Tardy").val(item.Tardy);
                            $("#Absent").val(item.Absent);
                            $("#Casual").val(item.Casual);
                            $("#Sick").val(item.Sick);
                            $("#TransDate").val(item.TransDate);
                            $("#Appraise").val(item.Appraise);
                            $("#EmpID").val(item.EmpID);
                        });
                    }
                    if (IsRead) {
                        $("#divMain input").attr("readonly", "readonly");
                        $("#divMain select").attr("disabled", "disabled");
                        $("#btnSlaves,#btnClear").hide();
                    }
                }
            })
        }
        else {
            var _Exist = {
                PostData: {
                    Params: {
                        Result: "TryPositivedata",
                        EmpID: GetSession("UserID")
                    },
                    ProcName: "proc_SOM_HR_EmpPositive",
                    DataType: "DataTable",
                    ExecType: "PROC",
                    Mode: "MSSQL"
                },
                async: false
            };
            var _IsExist = $honesty.AjaxChannel(_Exist);
            if (_IsExist["Data"].length < 4) {
                $honesty.ShowMsg({
                    title: "提示",
                    msg: "培训科目未完成4门，请重新确认"
                })
                return false;
            }
            else {
                $.each(_IsExist["Data"], function (i, item) {
                    if (item.SN != "") {
                        $honesty.ShowMsg({ title: "警告", msg: "该员工已转正,无需多次提交!" });
                        $honesty.CloseWin();
                    }
                });
                PositiveID = $honestyFlow.GetFlowInfo("instanceid");
                $("#InfoSN").html($honestyFlow.GetFlowInfo("SN"));
                $("#InfoWriteDate").html($honesty.NowDate().Format("yyyy-MM-dd"));
                $("#InfoEmpCode").html(GetSession("UserCode"));
                $("#InfoInDate").html(GetSession("CreateDate"));
                $("#InfoEmpName").html(GetSession("UserName"));
                $("#InfoAreaName").html(GetSession("AreaName"));
                $("#InfoProvince").html(GetSession("Province"));
                $("#InfoSapCode").html(GetSession("SapCode"));
                $("#InfoShopName").html(GetSession("ShopName"));
                $("#InfoEmpPosition").html(GetSession("Position"));
                $("#InfoPositionAge").html(GetSession("PositionAge") + "天");
                var CountResults = 0;
                $.each(_IsExist["Data"], function (i, item) {
                    switch (item.Subject) {
                        case "基础商品知识": $("#Test1").val(item.avgResults); break;
                        case "基础销售技巧": $("#Test2").val(item.avgResults); break;
                        case "卡宾店铺服务标准": $("#Test3").val(item.avgResults); break;
                        case "卡宾品牌知识": $("#Test4").val(item.avgResults); break;
                    }

                    CountResults += Number(item.avgResults);
                    if (item.IsPass == -1) {
                        $("#PassThreeDay").val("不通过");
                    }
                    if (item.IsPass == -2) {
                        $("#PassThreeDay").val("通过");
                    }
                    $("#Tardy").val(item.TardyCount == "" ? 0 : item.TardyCount)
                    $("#Absent").val(item.AbsentDay == "" ? 0 : item.AbsentDay);
                    $("#Casual").val(item.CasualDay == "" ? 0 : item.CasualDay);
                    $("#Sick").val(item.SickDay == "" ? 0 : item.SickDay);
                });
                $("#Score").val(CountResults / _IsExist["Data"].length);
                //获取业绩达成率
                var _optionsKip = {
                    PostData: {
                        Params: {
                            result: "GetSaleKip",
                            EmpID: GetSession("UserID"),
                            ApplyDate: $honesty.NowDate(),
                        },
                        ProcName: "proc_SOM_HR_EmpTransfer",
                        DataType: "DataTable",
                        ExecType: "PROC",
                        Mode: "MSSQL"
                    },
                    async: false
                };
                var _resultKip = $honesty.AjaxChannel(_optionsKip);
                if (_resultKip.Code == "1") {
                    var _Maxrate = 0;
                    var _ContList = "";
                    if (_resultKip.Data.length > 0) {
                        $.each(_resultKip.Data, function (i, item) {

                            _ContList += item.ZYear + "年" + item.ZMonth + "月达成率为" + Number(item.rate).toFixed(2) + "%\n";
                            if (_Maxrate < Number(item.rate)) {
                                _Maxrate = Number(item.rate);
                            }
                        });
                        $("#KPI").val(_Maxrate.toFixed(2) + "%");
                        $("#KPIText").val(_ContList);
                    }
                    else {
                        $("#KPI").val("0" + "%");
                        $honesty.ShowMsg({ msg: "该员工暂无销售数据，请重新确认", title: "警告" });
                    }
                }
                //var begindate = GetSession("CreateDate").split('-');
                //var enddate = $honesty.NowDate().Format("yyyy-MM-dd").split('-');
                //var DiffMonth = Math.abs((parseInt(begindate[0]) * 12 + parseInt(begindate[1])) - (parseInt(enddate[0]) * 12 + parseInt(enddate[1])));
                //var _ESB = {
                //    PostData: {
                //        Params: {
                //            empId: GetSession("UserID"),
                //            months: DiffMonth
                //        },
                //        URL: "employeeEvent/employeeSaleData",
                //        Mode: "ESB",
                //        Handle: "GET"
                //    }, async: false
                //};
                //var _ESBresult = $honesty.AjaxChannel(_ESB);
                //if (_ESBresult.Data.returnCode == "000") {
                //    if (_ESBresult.Data.employeeSale.length > 0) {
                //        var _Maxrate = 0;
                //        var _ContList = "";
                //        $.each(_ESBresult.Data.employeeSale, function (i, item) {
                //            _ContList += item.year + "年" + item.month + "月达成率为" + Number(item.rate).toFixed(2) + "%\n";
                //            if (_Maxrate < Number(item.rate)) {
                //                _Maxrate = Number(item.rate);
                //            }
                //        });
                //        $("#KPI").val(_Maxrate.toFixed(2) + "%");
                //        $("#KPIText").val(_ContList);
                //    }
                //    else {
                //        $("#KPI").val("0" + "%");
                //        $honesty.ShowMsg({ msg: "该员工在SAP无销售数据", title: "警告" });
                //    }
                //}
                //else {
                //    $honesty.ShowMsg({ msg: _ESBresult.Data.returnMsg, title: "警告" });
                //}
            }
        }
    }
    function SaveData() {
        if ($honestyFlow.GetFlowInfo("stepname") == "店铺店长审批" || $honestyFlow.GetFlowInfo("stepname") == "区经审批") {
            if ($("#InfoPositionAge").html() < 15) {
                $honesty.ShowMsg({ msg: "岗龄未满15天,不予转正！", title: "警告" });
                return false;
            }
            if ($("#TransDate").val() == "") {
                $honesty.ShowMsg({ msg: "请选择转正生效日期！", title: "警告" });
                return false;
            }
            var _options = {
                PostData: {
                    Params: {
                        result: "ModifyTransDate",
                        ID: PositiveID,
                        TransDate: $("#TransDate").val(),
                    },
                    ProcName: "proc_SOM_HR_EmpPositive",
                    DataType: "Bool",
                    ExecType: "PROC",
                    Mode: "MSSQL"
                },
                async: false
            };
            var _result = $honesty.AjaxChannel(_options);
            if (_result.Data == "True") {
                return true;
            }
            else {
                $honesty.ShowMsg({ msg: "业务数据保存失败", title: "警告" });
                return false;
            }
        }
        if ($honestyFlow.GetFlowInfo("stepname") == "提出转正申请") {
            var _IsPositive = {
                PostData: {
                    Params: {
                        Result: "IsPositiveStutas",
                        EmpID: GetSession("UserID"),
                        SN: $("#InfoSN").html()
                    },
                    ProcName: "proc_SOM_HR_EmpPositive",
                    DataType: "DataTable",
                    ExecType: "PROC",
                    Mode: "MSSQL"
                },
                async: false
            };
            var _Tabel = $honesty.AjaxChannel(_IsPositive);
            var _Erre = true;
            if (_Tabel.Data.length > 0) {
                $.each(_Tabel.Data, function (i, item) {
                    $honesty.ShowMsg({ msg: "相同的同续签流程已存在，请先完成！流程信息：" + item.SN, title: "警告" });
                    _Erre = false;
                });
            }
            else {
                if (_Erre == false) {
                    return false;
                }
                var _KPI = $("#KPI").val().split("%");
                if (_KPI[0] < 100) {
                    $honesty.ShowMsg({ msg: "业绩达成率未满足条件!", title: "警告" });
                    return false;
                }
                if ($("#Tutor1").val() == "") {
                    $honesty.ShowMsg({ msg: "请填写带教师傅!", title: "警告" });
                    return false;
                }
                if ($("#Score").val() == "") {
                    $honesty.ShowMsg({ msg: "培训成绩为空，请确认后再发起!", title: "警告" });
                    return false;
                }
                if ($("#Score").val() < 90) {
                    $honesty.ShowMsg({ msg: "培训成绩小于90分,未满足条件!", title: "警告" });
                    return false;
                }
                if ($("#PassThreeDay").val() == "" || $("#PassThreeDay").val() == "不通过") {
                    $honesty.ShowMsg({ msg: "三天闯关成绩未达要求!", title: "警告" });
                    return false;
                }
                if ($("#Appraise").val() == "") {
                    $honesty.ShowMsg({ msg: "请填写自我评价!", title: "警告" });
                    return false;
                }
                var Slaves = "";
                $.each($("#tbSlaves tr[dataname='tbSlaves']"), function (i, item) {
                    Slaves += $(item).attr("value") + "|";
                });
                var _options = {
                    PostData: {
                        Params: {
                            result: "ModifyEmpPositive",
                            ID: PositiveID,
                            SN: $honestyFlow.GetFlowInfo("SN"),
                            EmpID: GetSession("UserID"),
                            EmpCode: GetSession("UserCode"),
                            EmpName: GetSession("UserName"),
                            OrganizeID: GetSession("OrganizeID"),
                            AreaName: GetSession("AreaName"),
                            CompanyName: GetSession("CompanyName"),
                            Province: GetSession("Province"),
                            SapCode: GetSession("SapCode"),
                            ShopName: GetSession("ShopName"),
                            EmpPosition: GetSession("Position"),
                            EmpLevel: GetSession("EmpLevel"),
                            LevelDesc: GetSession("LevelDesc"),
                            InDate: GetSession("CreateDate"),
                            PositionAge: GetSession("PositionAge"),
                            KPIText: $("#KPIText").val(),
                            KPI: $("#KPI").val(),
                            Test1: $("#Test1").val(),
                            Test2: $("#Test2").val(),
                            Test3: $("#Test3").val(),
                            Test4: $("#Test4").val(),
                            Score: $("#Score").val(),
                            Tutor1: $("#Tutor1").val(),
                            PassThreeDay: $("#PassThreeDay").val(),
                            Tardy: $("#Tardy").val(),
                            Absent: $("#Absent").val(),
                            Casual: $("#Casual").val(),
                            Sick: $("#Sick").val(),
                            Slaves: Slaves,
                            Appraise: $("#Appraise").val(),
                            Title: $honestyFlow.GetFlowInfo("title"),
                        },
                        ProcName: "proc_SOM_HR_EmpPositive",
                        DataType: "Bool",
                        ExecType: "PROC",
                        Mode: "MSSQL"
                    },
                    async: false
                };
                var _result = $honesty.AjaxChannel(_options);
                if (_result.Data == "True") {
                    return true;
                }
                else {
                    $honesty.ShowMsg({ msg: "业务数据保存失败", title: "警告" });
                    return false;
                }
            }
        }
        else {
            return true;
        }
    }
</script>
</html>
